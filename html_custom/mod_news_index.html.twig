{% extends request.ajax ? "layout_blank.html.twig" : "layout_default.html.twig" %}

{% block meta_title %}{{ 'News'|trans }}{% endblock %}
{% block body_class %}news-index{% endblock %}
{% block breadcrumb %}<li class="breadcrumb-item active" aria-current="page">{{ 'News'|trans }}</li>{% endblock %}

{% block content %}

{# ===== Styles 2025 (full white + radius) ===== #}
<style>
  :root{
    --ow-border: var(--bs-border-color, #e5e7eb);
    --ow-soft: 0 10px 26px rgba(13,71,255,.08);
  }
  body.news-index .card{ background:#fff !important; border:1px solid var(--ow-border) !important; border-radius:18px !important; box-shadow:var(--ow-soft) }
  body.news-index .card-header{ background:#fff !important; border-bottom:1px solid var(--ow-border) !important; border-top-left-radius:18px; border-top-right-radius:18px }
  body.news-index .card-body{ background:#fff !important; padding:20px !important }
  .ow-title{font-weight:800;margin:0}
  .ow-sub{color:#6b7280}
  .news-item{border:1px solid var(--ow-border); border-radius:16px; box-shadow:var(--ow-soft)}
  .news-item .date{color:#6b7280; font-size:.9rem}
  .news-item h3{font-weight:800; margin:0 0 .25rem}
  .news-item p{margin:.5rem 0 0}
  .news-link{display:inline-flex; align-items:center; gap:6px; text-decoration:none}
  .news-link:hover{text-decoration:underline}
</style>

<div class="row">
  <div class="col-md-12">
    <div class="card mb-4">
      <div class="card-header py-3">
        <h1 class="ow-title">{{ 'News & Announcements'|trans }}</h1>
        <div class="ow-sub small">{{ 'Track our latest information.'|trans }}</div>
      </div>

      <div class="card-body pb-0">
        {% set posts = guest.news_get_list({ "page": request.page, "per_page": 5 }) %}

        {% if posts.list %}
          {% for i, post in posts.list %}
            <div class="news-item mb-3">
              <div class="card-body">
                <h3 class="mb-1">{{ post.title }}</h3>
                <div class="date mb-2">{{ post.updated_at|format_datetime }}</div>

                <div class="mb-2">
                  {% if post.excerpt %}
                    {{ post.excerpt|truncate(220)|markdown }}
                  {% else %}
                    {{ post.content|truncate(220)|markdown }}
                  {% endif %}
                </div>

                <a class="news-link" href="{{ '/news'|link }}/{{ post.slug }}">
                  {{ 'Continue reading'|trans }}
                  <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                    <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                  </svg>
                </a>
              </div>
            </div>
          {% endfor %}

          <div class="pt-2 pb-3">
            {{ include('partial_pagination.html.twig', { 'list': posts }) }}
          </div>
        {% else %}
          <div class="text-center text-muted py-4">
            {{ 'No news or announcements'|trans }}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
